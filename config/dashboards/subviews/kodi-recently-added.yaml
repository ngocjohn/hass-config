type: custom:local-conditional-card
default: show
id: addedmovie
card:
  type: 'custom:layout-card'
  layout_type: 'custom:grid-layout'
  layout:
    margin: -1
  cards:
    - type: 'custom:decluttering-card'
      template: tailwind_movies
      variables:
        - entity: sensor.kodi_all_movies
    - type: custom:auto-entities
      card:
        type: horizontal-stack
      filter:
        template: |
          {%- set movies = state_attr('sensor.kodi_all_movies', 'data') |
          sort(attribute="release_date", reverse=false) | sort(attribute="date_added",
          reverse=true) -%}
          {%- for movie in movies -%}
            {%- if movie.title -%}
              {{
                { 'type': 'custom:popup-card',
                  'title': movie.title,
                  'entity': movie.tmdb_id,
                  'style': '--popup-min-width: 80vw;',
                  'card': {'type': 'iframe', 'aspect_ratio': '180%','url': movie.tmdb_link},
                }
              }},
            {%- endif %}
          {%- endfor %}
      card_param: cards
