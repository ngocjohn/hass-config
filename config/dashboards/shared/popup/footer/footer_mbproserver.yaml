action: fire-dom-event
browser_mod:
  service: browser_mod.popup
  data:
    title: MBPro Server
    content:
      type: custom:mod-card
      card_mod: !include ../../snippets/style_popup_footer.yaml
      card:
        type: custom:layout-card
        layout_type: custom:grid-layout
        layout: !include ../../snippets/popup_footer_layout.yaml
        cards:
          #################################################
          #                                               #
          #                HOME ASSISTANT                 #
          #                                               #
          #################################################
          - type: entities
            show_header_toggle: false
            card_mod:
              class: header nopadding
            entities:
              - entity: binary_sensor.macbookpro
                name: Active
                state_color: true
              - entity: sensor.mbproserver_connection_type
                name: Connection
              - entity: sensor.mbpro_uptime_usage
                name: Uptime
              - type: custom:bar-card
                width: 55%
                height: 2em
                decimal: 0
                unit_of_measurement: '%'
                positions: &bar_card_positions
                  icon: outside
                  indicator: 'off'
                  name: outside
                severity: &bar_card_severity
                  - color: '#9da0a2'
                    from: 0
                    to: 59
                  - color: '#9da0a2'
                    from: 60
                    to: 100
                entity_row: true
                entities:
                  - entity: sensor.mbpro_cpu_usage
                    name: Processor
                  - entity: sensor.mbpro_memory_usage
                    name: Memory
              - type: custom:hui-horizontal-stack-card
                cards:
                  - type: custom:button-card
                    name: Lock
                    icon: mdi:lock
                    tap_action:
                      action: call-service
                      service: shell_command.lock_mbpro
                    template: icon_name
                  - type: custom:button-card
                    name: Sleep
                    icon: mdi:power-sleep
                    tap_action:
                      action: call-service
                      service: shell_command.sleep_mbpro
                    template: icon_name
            footer:
              type: custom:mini-graph-card
              # name: Speedtest
              tap_action:
                action: call-service
                service: homeassistant.update_entity
                service_data:
                  entity_id: sensor.mbpro_cpu_usage
              entities:
                - entity: sensor.mbpro_cpu_usage
                  name: Processor
                  color: '#00bb33'
                - entity: sensor.mbpro_memory_usage
                  name: Memory
                  show_state: false
                  color: '#2196f3'
                  y_axis: secondary
              hours_to_show: 48
              hour24: true
              line_width: 3
              animate: true
              # upper_bound_secondary: 100
              show:
                name: false
                icon: false
                state: false
                legend: false
                fill: fade
                labels: true
                labels_secondary: false
                average: false
                extrema: false
                points: hover
          #################################################
          #                                               #
          #                UNIFI CONTROLLER               #
          #                                               #
          #################################################
          # - type: entities
          #   title: Router
          #   show_header_toggle: false
          #   card_mod:
          #     class: header nopadding
          #   entities:
          #     - entity: binary_sensor.arris_tg3442de_wan_status
          #       name: WAN Status
          #     # - entity: sensor.external_ip
          #     # - entity: binary_sensor.template_unifi_upgradable
          #     # - entity: sensor.template_ap_adopted
          #     - type: custom:multiple-entity-row
          #       entity: sensor.unifi_controller_clients
          #       icon: mdi:devices
          #       name: 'Total Clients'
          #       show_state: false
          #       secondary_info:
          #         entity: sensor.unifi_controller_clients
          #         unit: true
          #       entities:
          #         - attribute: wifi0
          #           name: 2.4GhZ
          #           unit: ' '
          #         - attribute: wifi1
          #           name: 5GhZ
          #           unit: ' '
          #         - attribute: wired
          #           name: Wired
          #           unit: ' '
          #     - type: custom:multiple-entity-row
          #       entity: binary_sensor.unifi_controller_alert
          #       name: 'Alert'
          #       state_color: true
          #       show_state: true
          #       secondary_info:
          #         attribute: Message
          #       entities:
          #         - icon: mdi:archive-minus
          #           tap_action:
          #             action: call-service
          #             confirmation:
          #               text: Are you sure you want to archive?
          #             service: input_button.press
          #             service_data:
          #               entity_id: input_button.unifi_archive_alerts
          #   footer:
          #     type: custom:mini-graph-card
          #     name: Speedtest
          #     tap_action:
          #       action: call-service
          #       service: homeassistant.update_entity
          #       service_data:
          #         entity_id: sensor.speedtest_download
          #     entities:
          #       - entity: sensor.speedtest_download
          #         name: Download
          #         color: '#00bb33'
          #       - entity: sensor.speedtest_upload
          #         name: Upload
          #         show_state: false
          #         color: '#2196f3'
          #         y_axis: secondary
          #     hours_to_show: 48
          #     hour24: true
          #     line_width: 3
          #     animate: true
          #     upper_bound_secondary: 100
          #     show:
          #       name: True
          #       icon: false
          #       state: true
          #       legend: true
          #       fill: fade
          #       labels: true
          #       labels_secondary: false
          #       average: true
          #       extrema: true
          #       points: hover
          #     card_mod:
          #       style: |
          #         .info__item__time {
          #           display: none !important;
          #         }
